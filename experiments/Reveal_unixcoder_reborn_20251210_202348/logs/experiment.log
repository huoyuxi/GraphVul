2025-12-10 20:23:48 | INFO | ================================================================================
2025-12-10 20:23:48 | INFO | Experiment: reborn_experiment (OPTIMIZED VERSION + UnixCoder global encoding)
2025-12-10 20:23:48 | INFO | Dataset: Reveal
2025-12-10 20:23:48 | INFO | Encoder: UNIXCODER
2025-12-10 20:23:48 | INFO | Device: cuda
2025-12-10 20:23:48 | INFO | Output: ./experiments_reborn/Reveal_unixcoder_reborn_20251210_202348
2025-12-10 20:23:48 | INFO | ================================================================================
2025-12-10 20:23:48 | INFO | 
================================================================================
2025-12-10 20:23:48 | INFO | STARTING ALL EXPERIMENTS (REBORN VERSION + UnixCoder global func_emb)
2025-12-10 20:23:48 | INFO | ================================================================================

2025-12-10 20:23:48 | INFO | STEP 1: Loading Data
2025-12-10 20:23:48 | INFO | Loading CPG data with UNIXCODER encoder...
2025-12-10 20:23:48 | INFO | ✓ Found complete dataset cache, loading...
2025-12-10 20:24:03 | INFO | ✓ Loaded from cache: Train=17970, Val=2246, Test=2247
2025-12-10 20:24:03 | INFO | 
======================================================================
2025-12-10 20:24:03 | INFO | LABEL DISTRIBUTION DIAGNOSIS
2025-12-10 20:24:03 | INFO | ======================================================================
2025-12-10 20:24:03 | INFO | Train Set:
2025-12-10 20:24:03 | INFO |   Normal (0):     16219 (90.3%)
2025-12-10 20:24:03 | INFO |   Vulnerable (1): 1751 (9.7%)
2025-12-10 20:24:03 | INFO |   Ratio (neg/pos): 9.26:1
2025-12-10 20:24:03 | INFO | 
Validation Set:
2025-12-10 20:24:03 | INFO |   Normal (0):     2027 (90.2%)
2025-12-10 20:24:03 | INFO |   Vulnerable (1):  219 (9.8%)
2025-12-10 20:24:03 | INFO | 
Test Set:
2025-12-10 20:24:03 | INFO |   Normal (0):     2028 (90.3%)
2025-12-10 20:24:03 | INFO |   Vulnerable (1):  219 (9.7%)
2025-12-10 20:24:03 | WARNING | ⚠ Moderate class imbalance detected! Ratio: 9.3:1
2025-12-10 20:24:03 | INFO | ======================================================================

2025-12-10 20:24:03 | INFO | Data preparation completed:
2025-12-10 20:24:03 | INFO |   Train: 17970 graphs
2025-12-10 20:24:03 | INFO |   Val:   2246 graphs
2025-12-10 20:24:03 | INFO |   Test:  2247 graphs
2025-12-10 20:24:03 | INFO |   Node feature dim: 768
2025-12-10 20:24:03 | INFO | 
================================================================================
2025-12-10 20:24:03 | INFO | STEP 2: Main Experiment (Full Reborn Model)
2025-12-10 20:24:03 | INFO | ================================================================================

2025-12-10 20:24:03 | INFO | Running experiment: full_model
2025-12-10 20:24:03 | INFO |   node_mil=True, tair=True, curriculum=True, pruning=True, contrastive=True
2025-12-10 20:24:04 | INFO | Starting training (Reborn Model with UnixCoder global func_emb)...
2025-12-10 20:24:06 | INFO | 
======================================================================
2025-12-10 20:24:06 | INFO | AUTO-CONFIGURATION FOR IMBALANCE
2025-12-10 20:24:06 | INFO | ======================================================================
2025-12-10 20:24:06 | INFO | Total: 17970, Neg: 16219, Pos: 1751
2025-12-10 20:24:06 | INFO | Imbalance ratio (neg:pos) = 9.26:1
2025-12-10 20:24:06 | INFO | → Severe imbalance, Focal + CE + Dice.
2025-12-10 20:24:06 | INFO | → Sufficient positives, SMOTE strategy=0.8.
2025-12-10 20:24:06 | INFO | → Class weights: [1.0, 6.09]
2025-12-10 20:24:06 | INFO | ======================================================================

2025-12-10 20:25:25 | INFO | Epoch 1/200 (78.2s) | Train Loss: 0.4501 Acc: 0.8434 | Val Loss: 23.8692 Acc: 0.7222 Prec: 0.2282 Rec: 0.7763 F1: 0.3527 | BestT: 0.42
2025-12-10 20:25:25 | INFO | ✓ Saved best model (Val F1: 0.3527, T=0.42)
2025-12-10 20:26:40 | INFO | Epoch 2/200 (75.4s) | Train Loss: 0.3885 Acc: 0.8578 | Val Loss: 24.3453 Acc: 0.7030 Prec: 0.2301 Rec: 0.8721 F1: 0.3642 | BestT: 0.12
2025-12-10 20:26:41 | INFO | ✓ Saved best model (Val F1: 0.3642, T=0.12)
2025-12-10 20:27:58 | INFO | Epoch 3/200 (76.5s) | Train Loss: 0.3638 Acc: 0.8620 | Val Loss: 24.6735 Acc: 0.7698 Prec: 0.2756 Rec: 0.8356 F1: 0.4145 | BestT: 0.18
2025-12-10 20:27:58 | INFO | ✓ Saved best model (Val F1: 0.4145, T=0.18)
2025-12-10 20:29:17 | INFO | Epoch 4/200 (78.8s) | Train Loss: 0.3360 Acc: 0.8667 | Val Loss: 25.5442 Acc: 0.8277 Prec: 0.3257 Rec: 0.7169 F1: 0.4479 | BestT: 0.37
2025-12-10 20:29:17 | INFO | ✓ Saved best model (Val F1: 0.4479, T=0.37)
2025-12-10 20:30:33 | INFO | Epoch 5/200 (75.5s) | Train Loss: 0.3225 Acc: 0.8720 | Val Loss: 25.8199 Acc: 0.7983 Prec: 0.3017 Rec: 0.8128 F1: 0.4400 | BestT: 0.20
2025-12-10 20:31:45 | INFO | Epoch 6/200 (71.5s) | Train Loss: 0.3169 Acc: 0.8753 | Val Loss: 24.6640 Acc: 0.8037 Prec: 0.3080 Rec: 0.8128 F1: 0.4467 | BestT: 0.14
2025-12-10 20:33:02 | INFO | Epoch 7/200 (76.2s) | Train Loss: 0.3051 Acc: 0.8771 | Val Loss: 24.8992 Acc: 0.7885 Prec: 0.2929 Rec: 0.8265 F1: 0.4325 | BestT: 0.21
2025-12-10 20:34:20 | INFO | Epoch 8/200 (77.2s) | Train Loss: 0.2920 Acc: 0.8837 | Val Loss: 24.9606 Acc: 0.8370 Prec: 0.3433 Rec: 0.7352 F1: 0.4680 | BestT: 0.21
2025-12-10 20:34:20 | INFO | ✓ Saved best model (Val F1: 0.4680, T=0.21)
2025-12-10 20:35:37 | INFO | Epoch 9/200 (76.6s) | Train Loss: 0.2848 Acc: 0.8883 | Val Loss: 25.0046 Acc: 0.8393 Prec: 0.3463 Rec: 0.7306 F1: 0.4699 | BestT: 0.26
2025-12-10 20:35:37 | INFO | ✓ Saved best model (Val F1: 0.4699, T=0.26)
2025-12-10 20:36:50 | INFO | Epoch 10/200 (72.8s) | Train Loss: 0.2780 Acc: 0.8886 | Val Loss: 25.0135 Acc: 0.8379 Prec: 0.3441 Rec: 0.7306 F1: 0.4678 | BestT: 0.22
2025-12-10 20:39:06 | INFO | Epoch 11/200 (135.3s) | Train Loss: 17.4608 Acc: 0.8903 | Val Loss: 9.5686 Acc: 0.7747 Prec: 0.2689 Rec: 0.7626 F1: 0.3976 | BestT: 0.05
2025-12-10 20:41:22 | INFO | Epoch 12/200 (135.2s) | Train Loss: 10.3668 Acc: 0.8890 | Val Loss: 7.4027 Acc: 0.7725 Prec: 0.2704 Rec: 0.7854 F1: 0.4023 | BestT: 0.10
2025-12-10 20:43:36 | INFO | Epoch 13/200 (134.3s) | Train Loss: 8.0947 Acc: 0.8861 | Val Loss: 6.3189 Acc: 0.7725 Prec: 0.2683 Rec: 0.7717 F1: 0.3981 | BestT: 0.05
2025-12-10 20:45:52 | INFO | Epoch 14/200 (135.7s) | Train Loss: 6.8610 Acc: 0.8882 | Val Loss: 5.5265 Acc: 0.7898 Prec: 0.2808 Rec: 0.7397 F1: 0.4070 | BestT: 0.08
2025-12-10 20:48:03 | INFO | Epoch 15/200 (130.5s) | Train Loss: 5.8451 Acc: 0.8844 | Val Loss: 5.0679 Acc: 0.8139 Prec: 0.3037 Rec: 0.7032 F1: 0.4242 | BestT: 0.05
2025-12-10 20:50:36 | INFO | Epoch 16/200 (152.8s) | Train Loss: 5.1878 Acc: 0.8922 | Val Loss: 4.5434 Acc: 0.8059 Prec: 0.3024 Rec: 0.7580 F1: 0.4323 | BestT: 0.09
2025-12-10 20:53:05 | INFO | Epoch 17/200 (148.4s) | Train Loss: 4.5870 Acc: 0.8882 | Val Loss: 4.1792 Acc: 0.7854 Prec: 0.2848 Rec: 0.7945 F1: 0.4193 | BestT: 0.10
2025-12-10 20:55:43 | INFO | Epoch 18/200 (158.0s) | Train Loss: 4.1248 Acc: 0.8921 | Val Loss: 3.9857 Acc: 0.8108 Prec: 0.3042 Rec: 0.7306 F1: 0.4295 | BestT: 0.09
2025-12-10 20:58:22 | INFO | Epoch 19/200 (158.1s) | Train Loss: 3.8212 Acc: 0.8943 | Val Loss: 3.7914 Acc: 0.7827 Prec: 0.2848 Rec: 0.8128 F1: 0.4218 | BestT: 0.05
2025-12-10 21:00:58 | INFO | Epoch 20/200 (156.2s) | Train Loss: 3.5044 Acc: 0.8944 | Val Loss: 3.7106 Acc: 0.8393 Prec: 0.3349 Rec: 0.6575 F1: 0.4438 | BestT: 0.08
2025-12-10 21:03:37 | INFO | Epoch 21/200 (158.1s) | Train Loss: 3.3858 Acc: 0.8957 | Val Loss: 3.4901 Acc: 0.7778 Prec: 0.2819 Rec: 0.8265 F1: 0.4204 | BestT: 0.06
2025-12-10 21:06:17 | INFO | Epoch 22/200 (159.9s) | Train Loss: 3.1376 Acc: 0.8972 | Val Loss: 3.4485 Acc: 0.8032 Prec: 0.3040 Rec: 0.7900 F1: 0.4391 | BestT: 0.05
2025-12-10 21:08:47 | INFO | Epoch 23/200 (149.4s) | Train Loss: 3.0411 Acc: 0.8979 | Val Loss: 3.3332 Acc: 0.7818 Prec: 0.2866 Rec: 0.8311 F1: 0.4262 | BestT: 0.05
2025-12-10 21:11:23 | INFO | Epoch 24/200 (155.9s) | Train Loss: 2.9818 Acc: 0.8990 | Val Loss: 3.3449 Acc: 0.8085 Prec: 0.3057 Rec: 0.7580 F1: 0.4357 | BestT: 0.05
2025-12-10 21:13:50 | INFO | Epoch 25/200 (147.0s) | Train Loss: 2.9134 Acc: 0.9038 | Val Loss: 3.2641 Acc: 0.7952 Prec: 0.2961 Rec: 0.7991 F1: 0.4321 | BestT: 0.05
2025-12-10 21:16:24 | INFO | Epoch 26/200 (152.9s) | Train Loss: 2.8245 Acc: 0.9019 | Val Loss: 3.2496 Acc: 0.8103 Prec: 0.3108 Rec: 0.7763 F1: 0.4439 | BestT: 0.06
2025-12-10 21:18:53 | INFO | Epoch 27/200 (149.6s) | Train Loss: 2.8282 Acc: 0.9025 | Val Loss: 3.2388 Acc: 0.8050 Prec: 0.3048 Rec: 0.7808 F1: 0.4385 | BestT: 0.05
2025-12-10 21:21:25 | INFO | Epoch 28/200 (151.3s) | Train Loss: 2.8064 Acc: 0.9043 | Val Loss: 3.2314 Acc: 0.8077 Prec: 0.3081 Rec: 0.7808 F1: 0.4419 | BestT: 0.05
2025-12-10 21:23:38 | INFO | Epoch 29/200 (132.4s) | Train Loss: 2.7797 Acc: 0.9046 | Val Loss: 3.2288 Acc: 0.8081 Prec: 0.3080 Rec: 0.7763 F1: 0.4410 | BestT: 0.05
2025-12-10 21:24:52 | INFO | Epoch 30/200 (73.7s) | Train Loss: 2.7841 Acc: 0.9060 | Val Loss: 3.2236 Acc: 0.8085 Prec: 0.3099 Rec: 0.7854 F1: 0.4444 | BestT: 0.05
2025-12-10 21:26:23 | INFO | Epoch 31/200 (90.4s) | Train Loss: 2.7650 Acc: 0.8959 | Val Loss: 2.9588 Acc: 0.7493 Prec: 0.2657 Rec: 0.8904 F1: 0.4092 | BestT: 0.07
2025-12-10 21:28:31 | INFO | Epoch 32/200 (128.2s) | Train Loss: 2.6139 Acc: 0.8940 | Val Loss: 2.9071 Acc: 0.8023 Prec: 0.3064 Rec: 0.8128 F1: 0.4450 | BestT: 0.05
2025-12-10 21:30:41 | INFO | Epoch 33/200 (129.1s) | Train Loss: 2.4397 Acc: 0.8964 | Val Loss: 2.7784 Acc: 0.7983 Prec: 0.2969 Rec: 0.7808 F1: 0.4302 | BestT: 0.05
2025-12-10 21:32:53 | INFO | Epoch 34/200 (132.2s) | Train Loss: 2.2911 Acc: 0.8983 | Val Loss: 2.5860 Acc: 0.7573 Prec: 0.2742 Rec: 0.9041 F1: 0.4208 | BestT: 0.05
2025-12-10 21:32:53 | INFO | Early stopping at epoch 34
2025-12-10 21:32:54 | INFO | Training completed. Best Val F1: 0.4699 | Best T: 0.26
2025-12-10 21:32:58 | INFO | 
============================================================
2025-12-10 21:32:58 | INFO | TEST RESULTS (MLP Classifier)
2025-12-10 21:32:58 | INFO | ============================================================
2025-12-10 21:32:58 | INFO | Threshold:   0.26
2025-12-10 21:32:58 | INFO | Accuracy:    0.8371
2025-12-10 21:32:58 | INFO | Precision:   0.3459
2025-12-10 21:32:58 | INFO | Recall:      0.7534
2025-12-10 21:32:58 | INFO | F1-Score:    0.4741
2025-12-10 21:32:58 | INFO | AUC:         0.8786
2025-12-10 21:32:58 | INFO | TP:  165  FP:  312
2025-12-10 21:32:58 | INFO | FN:   54  TN: 1716
2025-12-10 21:32:58 | INFO | ============================================================

2025-12-10 21:32:58 | INFO | ===== Training & Evaluating Graph LogReg =====
2025-12-10 21:32:58 | INFO | Collecting features for LogReg training...
2025-12-10 21:33:33 | INFO | Before SMOTETomek: Neg=16219, Pos=1751
2025-12-10 21:34:36 | INFO | After SMOTETomek: Neg=14913, Pos=11669
2025-12-10 21:34:36 | INFO | LogReg feature dim: 2048, Train: 26582, Val: 2246
2025-12-10 21:34:36 | INFO | Training LogReg (C=1.0)...
2025-12-10 21:36:09 | INFO |   Val F1=0.4145 at T=0.06
2025-12-10 21:36:09 | INFO | ✓ Best LogReg: {'C': 1.0}, Val F1=0.4145, T=0.06
2025-12-10 21:36:10 | INFO | Collecting features for LogReg testing...
2025-12-10 21:36:14 | INFO | 
============================================================
2025-12-10 21:36:14 | INFO | TEST RESULTS (Graph + LogReg)
2025-12-10 21:36:14 | INFO | ============================================================
2025-12-10 21:36:14 | INFO | Params: {'C': 1.0}, Threshold: 0.06
2025-12-10 21:36:14 | INFO | Accuracy: 0.8131
2025-12-10 21:36:14 | INFO | Precision: 0.3093
2025-12-10 21:36:14 | INFO | Recall: 0.7443
2025-12-10 21:36:14 | INFO | F1-Score: 0.4370
2025-12-10 21:36:14 | INFO | AUC: 0.8108
2025-12-10 21:36:14 | INFO | TP:  163  FP:  364
2025-12-10 21:36:14 | INFO | FN:   56  TN: 1664
2025-12-10 21:36:14 | INFO | ============================================================

2025-12-10 21:36:15 | INFO | 
================================================================================
2025-12-10 21:36:15 | INFO | STEP 3: Ablation Studies
2025-12-10 21:36:15 | INFO | ================================================================================

2025-12-10 21:36:15 | INFO | 
Ablation: wo_node_mil
2025-12-10 21:36:15 | INFO | Running experiment: wo_node_mil
2025-12-10 21:36:15 | INFO |   node_mil=False, tair=True, curriculum=True, pruning=True, contrastive=True
2025-12-10 21:36:15 | INFO | Starting training (Reborn Model with UnixCoder global func_emb)...
2025-12-10 21:36:18 | INFO | 
======================================================================
2025-12-10 21:36:18 | INFO | AUTO-CONFIGURATION FOR IMBALANCE
2025-12-10 21:36:18 | INFO | ======================================================================
2025-12-10 21:36:18 | INFO | Total: 17970, Neg: 16219, Pos: 1751
2025-12-10 21:36:18 | INFO | Imbalance ratio (neg:pos) = 9.26:1
2025-12-10 21:36:18 | INFO | → Severe imbalance, Focal + CE + Dice.
2025-12-10 21:36:18 | INFO | → Sufficient positives, SMOTE strategy=0.8.
2025-12-10 21:36:18 | INFO | → Class weights: [1.0, 6.09]
2025-12-10 21:36:18 | INFO | ======================================================================

2025-12-10 21:37:22 | INFO | Epoch 1/200 (64.0s) | Train Loss: 0.4559 Acc: 0.8378 | Val Loss: 22.7651 Acc: 0.7204 Prec: 0.2218 Rec: 0.7443 F1: 0.3417 | BestT: 0.27
2025-12-10 21:37:22 | INFO | ✓ Saved best model (Val F1: 0.3417, T=0.27)
2025-12-10 21:38:26 | INFO | Epoch 2/200 (63.9s) | Train Loss: 0.3931 Acc: 0.8527 | Val Loss: 23.3016 Acc: 0.8353 Prec: 0.3256 Rec: 0.6438 F1: 0.4325 | BestT: 0.41
2025-12-10 21:38:26 | INFO | ✓ Saved best model (Val F1: 0.4325, T=0.41)
2025-12-10 21:39:31 | INFO | Epoch 3/200 (64.8s) | Train Loss: 0.3612 Acc: 0.8606 | Val Loss: 24.0580 Acc: 0.7805 Prec: 0.2717 Rec: 0.7443 F1: 0.3980 | BestT: 0.12
2025-12-10 21:40:34 | INFO | Epoch 4/200 (62.6s) | Train Loss: 0.3315 Acc: 0.8681 | Val Loss: 24.6711 Acc: 0.7858 Prec: 0.2809 Rec: 0.7671 F1: 0.4113 | BestT: 0.05
2025-12-10 21:41:38 | INFO | Epoch 5/200 (62.6s) | Train Loss: 0.3186 Acc: 0.8753 | Val Loss: 25.2479 Acc: 0.7707 Prec: 0.2730 Rec: 0.8128 F1: 0.4087 | BestT: 0.10
2025-12-10 21:42:42 | INFO | Epoch 6/200 (64.5s) | Train Loss: 0.3194 Acc: 0.8741 | Val Loss: 23.1700 Acc: 0.8384 Prec: 0.3435 Rec: 0.7215 F1: 0.4654 | BestT: 0.23
2025-12-10 21:42:43 | INFO | ✓ Saved best model (Val F1: 0.4654, T=0.23)
2025-12-10 21:43:48 | INFO | Epoch 7/200 (65.1s) | Train Loss: 0.3034 Acc: 0.8790 | Val Loss: 23.3641 Acc: 0.7271 Prec: 0.2525 Rec: 0.9178 F1: 0.3961 | BestT: 0.08
2025-12-10 21:45:03 | INFO | Epoch 8/200 (74.9s) | Train Loss: 0.2952 Acc: 0.8833 | Val Loss: 23.4726 Acc: 0.8268 Prec: 0.3272 Rec: 0.7352 F1: 0.4529 | BestT: 0.09
2025-12-10 21:46:20 | INFO | Epoch 9/200 (76.6s) | Train Loss: 0.2882 Acc: 0.8877 | Val Loss: 23.5374 Acc: 0.7809 Prec: 0.2877 Rec: 0.8447 F1: 0.4292 | BestT: 0.05
2025-12-10 21:47:36 | INFO | Epoch 10/200 (75.5s) | Train Loss: 0.2816 Acc: 0.8869 | Val Loss: 23.5597 Acc: 0.8077 Prec: 0.3081 Rec: 0.7808 F1: 0.4419 | BestT: 0.07
2025-12-10 21:48:56 | INFO | Epoch 11/200 (79.2s) | Train Loss: 18.1050 Acc: 0.8933 | Val Loss: 9.1696 Acc: 0.7560 Prec: 0.2592 Rec: 0.8082 F1: 0.3925 | BestT: 0.25
2025-12-10 21:50:13 | INFO | Epoch 12/200 (76.9s) | Train Loss: 10.1761 Acc: 0.8880 | Val Loss: 7.2050 Acc: 0.7360 Prec: 0.2473 Rec: 0.8356 F1: 0.3816 | BestT: 0.05
2025-12-10 21:51:32 | INFO | Epoch 13/200 (79.1s) | Train Loss: 8.1332 Acc: 0.8902 | Val Loss: 6.0606 Acc: 0.7520 Prec: 0.2572 Rec: 0.8174 F1: 0.3913 | BestT: 0.06
2025-12-10 21:52:53 | INFO | Epoch 14/200 (80.4s) | Train Loss: 6.7081 Acc: 0.8864 | Val Loss: 5.3666 Acc: 0.8183 Prec: 0.3060 Rec: 0.6804 F1: 0.4221 | BestT: 0.08
2025-12-10 21:54:13 | INFO | Epoch 15/200 (79.4s) | Train Loss: 5.7065 Acc: 0.8874 | Val Loss: 4.7077 Acc: 0.7725 Prec: 0.2740 Rec: 0.8082 F1: 0.4092 | BestT: 0.13
2025-12-10 21:55:57 | INFO | Epoch 16/200 (103.4s) | Train Loss: 5.0419 Acc: 0.8844 | Val Loss: 4.5427 Acc: 0.8451 Prec: 0.3359 Rec: 0.6027 F1: 0.4314 | BestT: 0.05
2025-12-10 21:57:41 | INFO | Epoch 17/200 (103.8s) | Train Loss: 4.4710 Acc: 0.8858 | Val Loss: 4.0845 Acc: 0.7850 Prec: 0.2822 Rec: 0.7808 F1: 0.4145 | BestT: 0.06
2025-12-10 21:59:24 | INFO | Epoch 18/200 (102.6s) | Train Loss: 4.1411 Acc: 0.8900 | Val Loss: 4.0097 Acc: 0.8473 Prec: 0.3385 Rec: 0.5936 F1: 0.4312 | BestT: 0.05
2025-12-10 22:01:04 | INFO | Epoch 19/200 (99.6s) | Train Loss: 3.7055 Acc: 0.8914 | Val Loss: 3.6731 Acc: 0.8010 Prec: 0.2957 Rec: 0.7534 F1: 0.4247 | BestT: 0.05
2025-12-10 22:02:48 | INFO | Epoch 20/200 (103.8s) | Train Loss: 3.5056 Acc: 0.8913 | Val Loss: 3.6444 Acc: 0.8464 Prec: 0.3376 Rec: 0.5982 F1: 0.4316 | BestT: 0.05
2025-12-10 22:04:30 | INFO | Epoch 21/200 (101.6s) | Train Loss: 3.3773 Acc: 0.8951 | Val Loss: 3.4019 Acc: 0.8183 Prec: 0.3143 Rec: 0.7306 F1: 0.4396 | BestT: 0.06
2025-12-10 22:06:11 | INFO | Epoch 22/200 (101.0s) | Train Loss: 3.2116 Acc: 0.8960 | Val Loss: 3.2987 Acc: 0.8255 Prec: 0.3267 Rec: 0.7443 F1: 0.4540 | BestT: 0.07
2025-12-10 22:07:56 | INFO | Epoch 23/200 (104.1s) | Train Loss: 2.9990 Acc: 0.8971 | Val Loss: 3.1808 Acc: 0.8094 Prec: 0.3117 Rec: 0.7900 F1: 0.4470 | BestT: 0.08
2025-12-10 22:09:40 | INFO | Epoch 24/200 (103.8s) | Train Loss: 2.9219 Acc: 0.8977 | Val Loss: 3.1359 Acc: 0.7863 Prec: 0.2892 Rec: 0.8174 F1: 0.4272 | BestT: 0.05
2025-12-10 22:11:22 | INFO | Epoch 25/200 (102.0s) | Train Loss: 2.9315 Acc: 0.8991 | Val Loss: 3.0979 Acc: 0.7858 Prec: 0.2907 Rec: 0.8311 F1: 0.4308 | BestT: 0.05
2025-12-10 22:13:06 | INFO | Epoch 26/200 (103.3s) | Train Loss: 2.8274 Acc: 0.9007 | Val Loss: 3.1318 Acc: 0.8192 Prec: 0.3184 Rec: 0.7489 F1: 0.4469 | BestT: 0.05
2025-12-10 22:14:49 | INFO | Epoch 27/200 (102.4s) | Train Loss: 2.7394 Acc: 0.9021 | Val Loss: 3.0874 Acc: 0.8077 Prec: 0.3115 Rec: 0.8037 F1: 0.4490 | BestT: 0.05
2025-12-10 22:16:29 | INFO | Epoch 28/200 (99.7s) | Train Loss: 2.6806 Acc: 0.9023 | Val Loss: 3.0739 Acc: 0.8161 Prec: 0.3190 Rec: 0.7808 F1: 0.4530 | BestT: 0.06
2025-12-10 22:18:09 | INFO | Epoch 29/200 (100.5s) | Train Loss: 2.7136 Acc: 0.9041 | Val Loss: 3.0718 Acc: 0.8085 Prec: 0.3126 Rec: 0.8037 F1: 0.4501 | BestT: 0.05
2025-12-10 22:19:50 | INFO | Epoch 30/200 (100.1s) | Train Loss: 2.7784 Acc: 0.9041 | Val Loss: 3.0907 Acc: 0.8183 Prec: 0.3220 Rec: 0.7808 F1: 0.4560 | BestT: 0.05
2025-12-10 22:21:32 | INFO | Epoch 31/200 (101.5s) | Train Loss: 2.7612 Acc: 0.8944 | Val Loss: 2.8037 Acc: 0.8023 Prec: 0.3077 Rec: 0.8219 F1: 0.4478 | BestT: 0.14
2025-12-10 22:21:32 | INFO | Early stopping at epoch 31
2025-12-10 22:21:32 | INFO | Training completed. Best Val F1: 0.4654 | Best T: 0.23
2025-12-10 22:21:37 | INFO | 
============================================================
2025-12-10 22:21:37 | INFO | TEST RESULTS (MLP Classifier)
2025-12-10 22:21:37 | INFO | ============================================================
2025-12-10 22:21:37 | INFO | Threshold:   0.23
2025-12-10 22:21:37 | INFO | Accuracy:    0.8278
2025-12-10 22:21:37 | INFO | Precision:   0.3306
2025-12-10 22:21:37 | INFO | Recall:      0.7489
2025-12-10 22:21:37 | INFO | F1-Score:    0.4587
2025-12-10 22:21:37 | INFO | AUC:         0.8763
2025-12-10 22:21:37 | INFO | TP:  164  FP:  332
2025-12-10 22:21:37 | INFO | FN:   55  TN: 1696
2025-12-10 22:21:37 | INFO | ============================================================

2025-12-10 22:21:38 | INFO | ===== Training & Evaluating Graph LogReg =====
2025-12-10 22:21:38 | INFO | Collecting features for LogReg training...
2025-12-10 22:22:24 | INFO | Before SMOTETomek: Neg=16219, Pos=1751
2025-12-10 22:23:18 | INFO | After SMOTETomek: Neg=14919, Pos=11675
2025-12-10 22:23:18 | INFO | LogReg feature dim: 2048, Train: 26594, Val: 2246
2025-12-10 22:23:18 | INFO | Training LogReg (C=1.0)...
2025-12-10 22:24:18 | INFO |   Val F1=0.3842 at T=0.05
2025-12-10 22:24:18 | INFO | ✓ Best LogReg: {'C': 1.0}, Val F1=0.3842, T=0.05
2025-12-10 22:24:19 | INFO | Collecting features for LogReg testing...
2025-12-10 22:24:24 | INFO | 
============================================================
2025-12-10 22:24:24 | INFO | TEST RESULTS (Graph + LogReg)
2025-12-10 22:24:24 | INFO | ============================================================
2025-12-10 22:24:24 | INFO | Params: {'C': 1.0}, Threshold: 0.05
2025-12-10 22:24:24 | INFO | Accuracy: 0.7882
2025-12-10 22:24:24 | INFO | Precision: 0.2685
2025-12-10 22:24:24 | INFO | Recall: 0.6804
2025-12-10 22:24:24 | INFO | F1-Score: 0.3850
2025-12-10 22:24:24 | INFO | AUC: 0.7851
2025-12-10 22:24:24 | INFO | TP:  149  FP:  406
2025-12-10 22:24:24 | INFO | FN:   70  TN: 1622
2025-12-10 22:24:24 | INFO | ============================================================

2025-12-10 22:24:25 | INFO | 
Ablation: wo_tair
2025-12-10 22:24:25 | INFO | Running experiment: wo_tair
2025-12-10 22:24:25 | INFO |   node_mil=True, tair=False, curriculum=True, pruning=True, contrastive=True
2025-12-10 22:24:25 | INFO | Starting training (Reborn Model with UnixCoder global func_emb)...
2025-12-10 22:24:28 | INFO | 
======================================================================
2025-12-10 22:24:28 | INFO | AUTO-CONFIGURATION FOR IMBALANCE
2025-12-10 22:24:28 | INFO | ======================================================================
2025-12-10 22:24:28 | INFO | Total: 17970, Neg: 16219, Pos: 1751
2025-12-10 22:24:28 | INFO | Imbalance ratio (neg:pos) = 9.26:1
2025-12-10 22:24:28 | INFO | → Severe imbalance, Focal + CE + Dice.
2025-12-10 22:24:28 | INFO | → Sufficient positives, SMOTE strategy=0.8.
2025-12-10 22:24:28 | INFO | → Class weights: [1.0, 6.09]
2025-12-10 22:24:28 | INFO | ======================================================================

2025-12-10 22:25:49 | INFO | Epoch 1/200 (81.2s) | Train Loss: 0.4516 Acc: 0.8436 | Val Loss: 0.6512 Acc: 0.7222 Prec: 0.2311 Rec: 0.7945 F1: 0.3580 | BestT: 0.25
2025-12-10 22:25:49 | INFO | ✓ Saved best model (Val F1: 0.3580, T=0.25)
2025-12-10 22:27:04 | INFO | Epoch 2/200 (75.0s) | Train Loss: 0.3883 Acc: 0.8524 | Val Loss: 0.6424 Acc: 0.6843 Prec: 0.2184 Rec: 0.8676 F1: 0.3489 | BestT: 0.06
2025-12-10 22:28:07 | INFO | Epoch 3/200 (62.5s) | Train Loss: 0.3571 Acc: 0.8583 | Val Loss: 0.5392 Acc: 0.8651 Prec: 0.3807 Rec: 0.6119 F1: 0.4694 | BestT: 0.39
2025-12-10 22:28:07 | INFO | ✓ Saved best model (Val F1: 0.4694, T=0.39)
2025-12-10 22:29:03 | INFO | Epoch 4/200 (55.6s) | Train Loss: 0.3434 Acc: 0.8693 | Val Loss: 0.5348 Acc: 0.8272 Prec: 0.3313 Rec: 0.7580 F1: 0.4611 | BestT: 0.14
2025-12-10 22:29:58 | INFO | Epoch 5/200 (54.7s) | Train Loss: 0.3194 Acc: 0.8753 | Val Loss: 0.5030 Acc: 0.8117 Prec: 0.3139 Rec: 0.7854 F1: 0.4485 | BestT: 0.17
2025-12-10 22:30:55 | INFO | Epoch 6/200 (56.7s) | Train Loss: 0.3213 Acc: 0.8720 | Val Loss: 0.5122 Acc: 0.7743 Prec: 0.2791 Rec: 0.8311 F1: 0.4179 | BestT: 0.10
2025-12-10 22:31:52 | INFO | Epoch 7/200 (56.7s) | Train Loss: 0.3053 Acc: 0.8782 | Val Loss: 0.5406 Acc: 0.7885 Prec: 0.2922 Rec: 0.8219 F1: 0.4311 | BestT: 0.06
2025-12-10 22:32:52 | INFO | Epoch 8/200 (59.6s) | Train Loss: 0.2997 Acc: 0.8841 | Val Loss: 0.4862 Acc: 0.8290 Prec: 0.3320 Rec: 0.7443 F1: 0.4592 | BestT: 0.31
2025-12-10 22:33:47 | INFO | Epoch 9/200 (54.5s) | Train Loss: 0.2877 Acc: 0.8819 | Val Loss: 0.5171 Acc: 0.8210 Prec: 0.3237 Rec: 0.7671 F1: 0.4553 | BestT: 0.14
2025-12-10 22:34:44 | INFO | Epoch 10/200 (56.7s) | Train Loss: 0.2795 Acc: 0.8866 | Val Loss: 0.5035 Acc: 0.8183 Prec: 0.3200 Rec: 0.7671 F1: 0.4516 | BestT: 0.19
2025-12-10 22:36:18 | INFO | Epoch 11/200 (93.5s) | Train Loss: 0.3967 Acc: 0.8743 | Val Loss: 0.4392 Acc: 0.7320 Prec: 0.2529 Rec: 0.8950 F1: 0.3944 | BestT: 0.11
2025-12-10 22:37:52 | INFO | Epoch 12/200 (93.0s) | Train Loss: 0.3762 Acc: 0.8795 | Val Loss: 0.4318 Acc: 0.8531 Prec: 0.3682 Rec: 0.7078 F1: 0.4844 | BestT: 0.34
2025-12-10 22:37:52 | INFO | ✓ Saved best model (Val F1: 0.4844, T=0.34)
2025-12-10 22:39:23 | INFO | Epoch 13/200 (91.2s) | Train Loss: 0.3640 Acc: 0.8820 | Val Loss: 0.4468 Acc: 0.8134 Prec: 0.3195 Rec: 0.8082 F1: 0.4580 | BestT: 0.16
2025-12-10 22:40:51 | INFO | Epoch 14/200 (87.5s) | Train Loss: 0.3573 Acc: 0.8830 | Val Loss: 0.4949 Acc: 0.8598 Prec: 0.3835 Rec: 0.7215 F1: 0.5008 | BestT: 0.17
2025-12-10 22:40:51 | INFO | ✓ Saved best model (Val F1: 0.5008, T=0.17)
2025-12-10 22:42:20 | INFO | Epoch 15/200 (88.4s) | Train Loss: 0.3393 Acc: 0.8834 | Val Loss: 0.4375 Acc: 0.8335 Prec: 0.3471 Rec: 0.8037 F1: 0.4848 | BestT: 0.17
2025-12-10 22:44:09 | INFO | Epoch 16/200 (109.0s) | Train Loss: 0.3372 Acc: 0.8876 | Val Loss: 0.4418 Acc: 0.8535 Prec: 0.3733 Rec: 0.7397 F1: 0.4962 | BestT: 0.27
2025-12-10 22:45:59 | INFO | Epoch 17/200 (109.9s) | Train Loss: 0.3288 Acc: 0.8899 | Val Loss: 0.4567 Acc: 0.8370 Prec: 0.3533 Rec: 0.8082 F1: 0.4917 | BestT: 0.11
2025-12-10 22:47:47 | INFO | Epoch 18/200 (107.7s) | Train Loss: 0.3223 Acc: 0.8919 | Val Loss: 0.4618 Acc: 0.8085 Prec: 0.3190 Rec: 0.8493 F1: 0.4638 | BestT: 0.06
2025-12-10 22:49:36 | INFO | Epoch 19/200 (108.1s) | Train Loss: 0.3119 Acc: 0.8937 | Val Loss: 0.5159 Acc: 0.8415 Prec: 0.3599 Rec: 0.8037 F1: 0.4972 | BestT: 0.06
2025-12-10 22:51:20 | INFO | Epoch 20/200 (103.6s) | Train Loss: 0.3069 Acc: 0.8951 | Val Loss: 0.4438 Acc: 0.8580 Prec: 0.3869 Rec: 0.7808 F1: 0.5174 | BestT: 0.21
2025-12-10 22:51:20 | INFO | ✓ Saved best model (Val F1: 0.5174, T=0.21)
2025-12-10 22:53:09 | INFO | Epoch 21/200 (109.1s) | Train Loss: 0.2944 Acc: 0.8945 | Val Loss: 0.4318 Acc: 0.8411 Prec: 0.3631 Rec: 0.8356 F1: 0.5062 | BestT: 0.12
2025-12-10 22:55:01 | INFO | Epoch 22/200 (111.1s) | Train Loss: 0.2842 Acc: 0.8981 | Val Loss: 0.5776 Acc: 0.8669 Prec: 0.4000 Rec: 0.7306 F1: 0.5170 | BestT: 0.06
2025-12-10 22:56:44 | INFO | Epoch 23/200 (102.8s) | Train Loss: 0.2859 Acc: 0.8992 | Val Loss: 0.4142 Acc: 0.8455 Prec: 0.3699 Rec: 0.8311 F1: 0.5120 | BestT: 0.17
2025-12-10 22:58:33 | INFO | Epoch 24/200 (108.9s) | Train Loss: 0.2769 Acc: 0.9020 | Val Loss: 0.4780 Acc: 0.8459 Prec: 0.3717 Rec: 0.8402 F1: 0.5154 | BestT: 0.07
2025-12-10 23:00:23 | INFO | Epoch 25/200 (109.4s) | Train Loss: 0.2751 Acc: 0.9002 | Val Loss: 0.4741 Acc: 0.8522 Prec: 0.3811 Rec: 0.8265 F1: 0.5216 | BestT: 0.10
2025-12-10 23:00:23 | INFO | ✓ Saved best model (Val F1: 0.5216, T=0.10)
2025-12-10 23:02:08 | INFO | Epoch 26/200 (105.1s) | Train Loss: 0.2680 Acc: 0.9036 | Val Loss: 0.4492 Acc: 0.8522 Prec: 0.3820 Rec: 0.8356 F1: 0.5244 | BestT: 0.12
2025-12-10 23:02:09 | INFO | ✓ Saved best model (Val F1: 0.5244, T=0.12)
2025-12-10 23:03:57 | INFO | Epoch 27/200 (107.6s) | Train Loss: 0.2630 Acc: 0.9042 | Val Loss: 0.4795 Acc: 0.8549 Prec: 0.3849 Rec: 0.8174 F1: 0.5234 | BestT: 0.10
2025-12-10 23:05:44 | INFO | Epoch 28/200 (107.5s) | Train Loss: 0.2643 Acc: 0.9037 | Val Loss: 0.4882 Acc: 0.8575 Prec: 0.3905 Rec: 0.8219 F1: 0.5294 | BestT: 0.09
2025-12-10 23:05:44 | INFO | ✓ Saved best model (Val F1: 0.5294, T=0.09)
2025-12-10 23:07:36 | INFO | Epoch 29/200 (111.0s) | Train Loss: 0.2548 Acc: 0.9061 | Val Loss: 0.4904 Acc: 0.8531 Prec: 0.3822 Rec: 0.8219 F1: 0.5217 | BestT: 0.08
2025-12-10 23:09:24 | INFO | Epoch 30/200 (108.0s) | Train Loss: 0.2643 Acc: 0.9048 | Val Loss: 0.4802 Acc: 0.8531 Prec: 0.3827 Rec: 0.8265 F1: 0.5231 | BestT: 0.09
2025-12-10 23:11:06 | INFO | Epoch 31/200 (101.1s) | Train Loss: 0.2968 Acc: 0.9003 | Val Loss: 0.5964 Acc: 0.8620 Prec: 0.3924 Rec: 0.7580 F1: 0.5171 | BestT: 0.05
2025-12-10 23:12:49 | INFO | Epoch 32/200 (103.0s) | Train Loss: 0.2998 Acc: 0.8987 | Val Loss: 0.4590 Acc: 0.8549 Prec: 0.3854 Rec: 0.8219 F1: 0.5248 | BestT: 0.14
2025-12-10 23:14:38 | INFO | Epoch 33/200 (108.4s) | Train Loss: 0.2949 Acc: 0.8971 | Val Loss: 0.5496 Acc: 0.8624 Prec: 0.3986 Rec: 0.8082 F1: 0.5339 | BestT: 0.05
2025-12-10 23:14:38 | INFO | ✓ Saved best model (Val F1: 0.5339, T=0.05)
2025-12-10 23:16:26 | INFO | Epoch 34/200 (108.4s) | Train Loss: 0.2837 Acc: 0.9002 | Val Loss: 0.5304 Acc: 0.8535 Prec: 0.3799 Rec: 0.7945 F1: 0.5140 | BestT: 0.08
2025-12-10 23:18:15 | INFO | Epoch 35/200 (108.2s) | Train Loss: 0.2813 Acc: 0.8975 | Val Loss: 0.5036 Acc: 0.8526 Prec: 0.3793 Rec: 0.8037 F1: 0.5154 | BestT: 0.10
2025-12-10 23:20:04 | INFO | Epoch 36/200 (109.0s) | Train Loss: 0.2789 Acc: 0.8977 | Val Loss: 0.5382 Acc: 0.8540 Prec: 0.3828 Rec: 0.8128 F1: 0.5205 | BestT: 0.05
2025-12-10 23:21:50 | INFO | Epoch 37/200 (105.0s) | Train Loss: 0.2740 Acc: 0.9009 | Val Loss: 0.4974 Acc: 0.8406 Prec: 0.3650 Rec: 0.8584 F1: 0.5123 | BestT: 0.05
2025-12-10 23:23:35 | INFO | Epoch 38/200 (105.3s) | Train Loss: 0.2651 Acc: 0.9013 | Val Loss: 0.5804 Acc: 0.8615 Prec: 0.3925 Rec: 0.7671 F1: 0.5193 | BestT: 0.06
2025-12-10 23:25:18 | INFO | Epoch 39/200 (102.2s) | Train Loss: 0.2621 Acc: 0.9027 | Val Loss: 0.5249 Acc: 0.8598 Prec: 0.3929 Rec: 0.8037 F1: 0.5277 | BestT: 0.10
2025-12-10 23:27:06 | INFO | Epoch 40/200 (108.1s) | Train Loss: 0.2613 Acc: 0.9006 | Val Loss: 0.5460 Acc: 0.8486 Prec: 0.3721 Rec: 0.8037 F1: 0.5087 | BestT: 0.05
2025-12-10 23:28:58 | INFO | Epoch 41/200 (111.4s) | Train Loss: 0.2547 Acc: 0.9011 | Val Loss: 0.6649 Acc: 0.8633 Prec: 0.3911 Rec: 0.7215 F1: 0.5072 | BestT: 0.05
2025-12-10 23:30:48 | INFO | Epoch 42/200 (109.1s) | Train Loss: 0.2530 Acc: 0.9031 | Val Loss: 0.7809 Acc: 0.8678 Prec: 0.3946 Rec: 0.6667 F1: 0.4958 | BestT: 0.05
2025-12-10 23:32:36 | INFO | Epoch 43/200 (108.2s) | Train Loss: 0.2502 Acc: 0.9053 | Val Loss: 0.5486 Acc: 0.8477 Prec: 0.3716 Rec: 0.8128 F1: 0.5100 | BestT: 0.05
2025-12-10 23:34:26 | INFO | Epoch 44/200 (109.7s) | Train Loss: 0.2417 Acc: 0.9058 | Val Loss: 0.6063 Acc: 0.8549 Prec: 0.3798 Rec: 0.7717 F1: 0.5090 | BestT: 0.05
2025-12-10 23:36:14 | INFO | Epoch 45/200 (107.7s) | Train Loss: 0.2389 Acc: 0.9048 | Val Loss: 0.7624 Acc: 0.8620 Prec: 0.3812 Rec: 0.6667 F1: 0.4850 | BestT: 0.05
2025-12-10 23:38:00 | INFO | Epoch 46/200 (104.9s) | Train Loss: 0.2408 Acc: 0.9058 | Val Loss: 0.7711 Acc: 0.8606 Prec: 0.3770 Rec: 0.6575 F1: 0.4792 | BestT: 0.06
2025-12-10 23:39:47 | INFO | Epoch 47/200 (106.8s) | Train Loss: 0.2314 Acc: 0.9060 | Val Loss: 0.6995 Acc: 0.8606 Prec: 0.3825 Rec: 0.6986 F1: 0.4943 | BestT: 0.06
2025-12-10 23:41:35 | INFO | Epoch 48/200 (108.3s) | Train Loss: 0.2286 Acc: 0.9073 | Val Loss: 0.5594 Acc: 0.8522 Prec: 0.3758 Rec: 0.7808 F1: 0.5074 | BestT: 0.09
2025-12-10 23:43:25 | INFO | Epoch 49/200 (109.3s) | Train Loss: 0.2259 Acc: 0.9086 | Val Loss: 0.7642 Acc: 0.8642 Prec: 0.3874 Rec: 0.6758 F1: 0.4925 | BestT: 0.06
2025-12-10 23:45:12 | INFO | Epoch 50/200 (107.1s) | Train Loss: 0.2231 Acc: 0.9071 | Val Loss: 0.6862 Acc: 0.8615 Prec: 0.3883 Rec: 0.7306 F1: 0.5071 | BestT: 0.06
2025-12-10 23:47:19 | INFO | Epoch 51/200 (126.8s) | Train Loss: 0.2178 Acc: 0.9085 | Val Loss: 0.5646 Acc: 0.8477 Prec: 0.3694 Rec: 0.7945 F1: 0.5043 | BestT: 0.05
2025-12-10 23:49:19 | INFO | Epoch 52/200 (118.9s) | Train Loss: 0.2154 Acc: 0.9090 | Val Loss: 0.7184 Acc: 0.8584 Prec: 0.3807 Rec: 0.7215 F1: 0.4984 | BestT: 0.05
2025-12-10 23:51:42 | INFO | Epoch 53/200 (142.5s) | Train Loss: 0.2164 Acc: 0.9104 | Val Loss: 0.7909 Acc: 0.8580 Prec: 0.3711 Rec: 0.6575 F1: 0.4745 | BestT: 0.05
2025-12-10 23:53:59 | INFO | Epoch 54/200 (137.6s) | Train Loss: 0.2103 Acc: 0.9112 | Val Loss: 0.7430 Acc: 0.8602 Prec: 0.3827 Rec: 0.7078 F1: 0.4968 | BestT: 0.05
2025-12-10 23:56:27 | INFO | Epoch 55/200 (147.6s) | Train Loss: 0.2107 Acc: 0.9113 | Val Loss: 0.6789 Acc: 0.8580 Prec: 0.3804 Rec: 0.7260 F1: 0.4992 | BestT: 0.06
2025-12-10 23:58:50 | INFO | Epoch 56/200 (141.6s) | Train Loss: 0.2097 Acc: 0.9119 | Val Loss: 0.7662 Acc: 0.8593 Prec: 0.3802 Rec: 0.7032 F1: 0.4936 | BestT: 0.05
2025-12-11 00:01:13 | INFO | Epoch 57/200 (142.9s) | Train Loss: 0.2072 Acc: 0.9110 | Val Loss: 0.8250 Acc: 0.8606 Prec: 0.3763 Rec: 0.6530 F1: 0.4775 | BestT: 0.05
2025-12-11 00:03:38 | INFO | Epoch 58/200 (144.7s) | Train Loss: 0.2029 Acc: 0.9124 | Val Loss: 0.7956 Acc: 0.8598 Prec: 0.3794 Rec: 0.6895 F1: 0.4895 | BestT: 0.05
2025-12-11 00:03:38 | INFO | Early stopping at epoch 58
2025-12-11 00:03:39 | INFO | Training completed. Best Val F1: 0.5339 | Best T: 0.05
2025-12-11 00:03:43 | INFO | 
============================================================
2025-12-11 00:03:43 | INFO | TEST RESULTS (MLP Classifier)
2025-12-11 00:03:43 | INFO | ============================================================
2025-12-11 00:03:43 | INFO | Threshold:   0.05
2025-12-11 00:03:43 | INFO | Accuracy:    0.8496
2025-12-11 00:03:43 | INFO | Precision:   0.3737
2025-12-11 00:03:43 | INFO | Recall:      0.8037
2025-12-11 00:03:43 | INFO | F1-Score:    0.5101
2025-12-11 00:03:43 | INFO | AUC:         0.8843
2025-12-11 00:03:43 | INFO | TP:  176  FP:  295
2025-12-11 00:03:43 | INFO | FN:   43  TN: 1733
2025-12-11 00:03:43 | INFO | ============================================================

2025-12-11 00:03:43 | INFO | ===== Training & Evaluating Graph LogReg =====
2025-12-11 00:03:43 | INFO | Collecting features for LogReg training...
2025-12-11 00:04:19 | INFO | Before SMOTETomek: Neg=16219, Pos=1751
2025-12-11 00:05:14 | INFO | After SMOTETomek: Neg=14916, Pos=11672
2025-12-11 00:05:14 | INFO | LogReg feature dim: 2048, Train: 26588, Val: 2246
2025-12-11 00:05:14 | INFO | Training LogReg (C=1.0)...
2025-12-11 00:06:12 | INFO |   Val F1=0.4296 at T=0.05
2025-12-11 00:06:12 | INFO | ✓ Best LogReg: {'C': 1.0}, Val F1=0.4296, T=0.05
2025-12-11 00:06:13 | INFO | Collecting features for LogReg testing...
2025-12-11 00:06:17 | INFO | 
============================================================
2025-12-11 00:06:17 | INFO | TEST RESULTS (Graph + LogReg)
2025-12-11 00:06:17 | INFO | ============================================================
2025-12-11 00:06:17 | INFO | Params: {'C': 1.0}, Threshold: 0.05
2025-12-11 00:06:17 | INFO | Accuracy: 0.8296
2025-12-11 00:06:17 | INFO | Precision: 0.3145
2025-12-11 00:06:17 | INFO | Recall: 0.6347
2025-12-11 00:06:17 | INFO | F1-Score: 0.4206
2025-12-11 00:06:17 | INFO | AUC: 0.8036
2025-12-11 00:06:17 | INFO | TP:  139  FP:  303
2025-12-11 00:06:17 | INFO | FN:   80  TN: 1725
2025-12-11 00:06:17 | INFO | ============================================================

2025-12-11 00:06:18 | INFO | 
Ablation: wo_curriculum
2025-12-11 00:06:18 | INFO | Running experiment: wo_curriculum
2025-12-11 00:06:18 | INFO |   node_mil=True, tair=True, curriculum=False, pruning=False, contrastive=True
2025-12-11 00:06:18 | INFO | Starting training (Reborn Model with UnixCoder global func_emb)...
2025-12-11 00:06:21 | INFO | 
======================================================================
2025-12-11 00:06:21 | INFO | AUTO-CONFIGURATION FOR IMBALANCE
2025-12-11 00:06:21 | INFO | ======================================================================
2025-12-11 00:06:21 | INFO | Total: 17970, Neg: 16219, Pos: 1751
2025-12-11 00:06:21 | INFO | Imbalance ratio (neg:pos) = 9.26:1
2025-12-11 00:06:21 | INFO | → Severe imbalance, Focal + CE + Dice.
2025-12-11 00:06:21 | INFO | → Sufficient positives, SMOTE strategy=0.8.
2025-12-11 00:06:21 | INFO | → Class weights: [1.0, 6.09]
2025-12-11 00:06:21 | INFO | ======================================================================

2025-12-11 00:07:29 | INFO | Epoch 1/200 (68.3s) | Train Loss: 0.4561 Acc: 0.8412 | Val Loss: 23.4786 Acc: 0.7814 Prec: 0.2733 Rec: 0.7489 F1: 0.4005 | BestT: 0.29
2025-12-11 00:07:29 | INFO | ✓ Saved best model (Val F1: 0.4005, T=0.29)
2025-12-11 00:08:40 | INFO | Epoch 2/200 (70.3s) | Train Loss: 0.3863 Acc: 0.8528 | Val Loss: 24.0146 Acc: 0.7983 Prec: 0.2911 Rec: 0.7443 F1: 0.4185 | BestT: 0.26
2025-12-11 00:08:40 | INFO | ✓ Saved best model (Val F1: 0.4185, T=0.26)
2025-12-11 00:09:51 | INFO | Epoch 3/200 (70.2s) | Train Loss: 0.3597 Acc: 0.8668 | Val Loss: 24.5939 Acc: 0.7658 Prec: 0.2656 Rec: 0.7945 F1: 0.3982 | BestT: 0.06
2025-12-11 00:10:57 | INFO | Epoch 4/200 (65.8s) | Train Loss: 0.3384 Acc: 0.8686 | Val Loss: 25.1888 Acc: 0.7378 Prec: 0.2559 Rec: 0.8858 F1: 0.3971 | BestT: 0.15
2025-12-11 00:12:05 | INFO | Epoch 5/200 (67.0s) | Train Loss: 0.3178 Acc: 0.8785 | Val Loss: 25.5025 Acc: 0.7752 Prec: 0.2846 Rec: 0.8630 F1: 0.4281 | BestT: 0.11
2025-12-11 00:12:05 | INFO | ✓ Saved best model (Val F1: 0.4281, T=0.11)
2025-12-11 00:13:16 | INFO | Epoch 6/200 (70.4s) | Train Loss: 0.3002 Acc: 0.8824 | Val Loss: 26.0271 Acc: 0.8375 Prec: 0.3453 Rec: 0.7443 F1: 0.4718 | BestT: 0.34
2025-12-11 00:13:16 | INFO | ✓ Saved best model (Val F1: 0.4718, T=0.34)
2025-12-11 00:14:28 | INFO | Epoch 7/200 (71.6s) | Train Loss: 0.2892 Acc: 0.8868 | Val Loss: 26.2301 Acc: 0.7703 Prec: 0.2857 Rec: 0.9041 F1: 0.4342 | BestT: 0.09
2025-12-11 00:15:40 | INFO | Epoch 8/200 (71.9s) | Train Loss: 0.2664 Acc: 0.8900 | Val Loss: 26.3959 Acc: 0.8148 Prec: 0.3244 Rec: 0.8311 F1: 0.4667 | BestT: 0.09
2025-12-11 00:16:52 | INFO | Epoch 9/200 (71.5s) | Train Loss: 0.2653 Acc: 0.8919 | Val Loss: 26.4476 Acc: 0.8001 Prec: 0.3090 Rec: 0.8493 F1: 0.4531 | BestT: 0.08
2025-12-11 00:18:01 | INFO | Epoch 10/200 (68.8s) | Train Loss: 0.2598 Acc: 0.8960 | Val Loss: 26.4753 Acc: 0.8045 Prec: 0.3142 Rec: 0.8493 F1: 0.4587 | BestT: 0.08
2025-12-11 00:20:07 | INFO | Epoch 11/200 (125.6s) | Train Loss: 15.2424 Acc: 0.8937 | Val Loss: 9.1567 Acc: 0.6892 Prec: 0.2294 Rec: 0.9269 F1: 0.3678 | BestT: 0.11
2025-12-11 00:22:09 | INFO | Epoch 12/200 (121.8s) | Train Loss: 9.1852 Acc: 0.8849 | Val Loss: 7.3967 Acc: 0.8085 Prec: 0.2998 Rec: 0.7215 F1: 0.4236 | BestT: 0.05
2025-12-11 00:24:08 | INFO | Epoch 13/200 (118.6s) | Train Loss: 7.4889 Acc: 0.8828 | Val Loss: 6.7920 Acc: 0.9038 Prec: 1.0000 Rec: 0.0137 F1: 0.0270 | BestT: 0.21
2025-12-11 00:26:17 | INFO | Epoch 14/200 (128.6s) | Train Loss: 6.3027 Acc: 0.8880 | Val Loss: 5.4890 Acc: 0.7876 Prec: 0.2857 Rec: 0.7854 F1: 0.4190 | BestT: 0.05
2025-12-11 00:28:26 | INFO | Epoch 15/200 (128.3s) | Train Loss: 5.5601 Acc: 0.8894 | Val Loss: 4.8044 Acc: 0.7284 Prec: 0.2516 Rec: 0.9041 F1: 0.3936 | BestT: 0.10
2025-12-11 00:30:52 | INFO | Epoch 16/200 (145.7s) | Train Loss: 4.9509 Acc: 0.8910 | Val Loss: 4.5421 Acc: 0.8362 Prec: 0.3326 Rec: 0.6758 F1: 0.4458 | BestT: 0.09
2025-12-11 00:33:19 | INFO | Epoch 17/200 (146.9s) | Train Loss: 4.4929 Acc: 0.8876 | Val Loss: 4.0960 Acc: 0.7297 Prec: 0.2519 Rec: 0.8995 F1: 0.3936 | BestT: 0.06
2025-12-11 00:35:50 | INFO | Epoch 18/200 (151.0s) | Train Loss: 4.1448 Acc: 0.8916 | Val Loss: 3.9183 Acc: 0.8255 Prec: 0.3224 Rec: 0.7169 F1: 0.4448 | BestT: 0.10
2025-12-11 00:38:16 | INFO | Epoch 19/200 (145.3s) | Train Loss: 3.8254 Acc: 0.8919 | Val Loss: 3.7193 Acc: 0.8143 Prec: 0.3132 Rec: 0.7580 F1: 0.4433 | BestT: 0.09
2025-12-11 00:40:45 | INFO | Epoch 20/200 (148.8s) | Train Loss: 3.5612 Acc: 0.8949 | Val Loss: 3.5188 Acc: 0.7756 Prec: 0.2851 Rec: 0.8630 F1: 0.4286 | BestT: 0.07
2025-12-11 00:43:14 | INFO | Epoch 21/200 (147.9s) | Train Loss: 3.4741 Acc: 0.8958 | Val Loss: 3.4312 Acc: 0.8152 Prec: 0.3172 Rec: 0.7763 F1: 0.4503 | BestT: 0.09
2025-12-11 00:45:43 | INFO | Epoch 22/200 (148.8s) | Train Loss: 3.3147 Acc: 0.8979 | Val Loss: 3.3128 Acc: 0.7587 Prec: 0.2716 Rec: 0.8767 F1: 0.4147 | BestT: 0.05
2025-12-11 00:48:10 | INFO | Epoch 23/200 (146.7s) | Train Loss: 3.1233 Acc: 0.8967 | Val Loss: 3.3841 Acc: 0.8353 Prec: 0.3355 Rec: 0.7032 F1: 0.4543 | BestT: 0.05
2025-12-11 00:50:28 | INFO | Epoch 24/200 (137.7s) | Train Loss: 3.1190 Acc: 0.8984 | Val Loss: 3.2139 Acc: 0.7832 Prec: 0.2873 Rec: 0.8265 F1: 0.4264 | BestT: 0.05
2025-12-11 00:52:53 | INFO | Epoch 25/200 (144.6s) | Train Loss: 3.0059 Acc: 0.9008 | Val Loss: 3.1866 Acc: 0.7934 Prec: 0.2982 Rec: 0.8265 F1: 0.4383 | BestT: 0.05
2025-12-11 00:55:11 | INFO | Epoch 26/200 (138.3s) | Train Loss: 2.9485 Acc: 0.9014 | Val Loss: 3.1387 Acc: 0.7965 Prec: 0.3023 Rec: 0.8311 F1: 0.4434 | BestT: 0.06
2025-12-11 00:57:36 | INFO | Epoch 27/200 (143.9s) | Train Loss: 2.8857 Acc: 0.9024 | Val Loss: 3.1293 Acc: 0.7912 Prec: 0.2984 Rec: 0.8447 F1: 0.4410 | BestT: 0.05
2025-12-11 01:00:03 | INFO | Epoch 28/200 (147.2s) | Train Loss: 2.8447 Acc: 0.9025 | Val Loss: 3.1616 Acc: 0.8197 Prec: 0.3198 Rec: 0.7534 F1: 0.4490 | BestT: 0.06
2025-12-11 01:02:28 | INFO | Epoch 29/200 (144.9s) | Train Loss: 2.8392 Acc: 0.9032 | Val Loss: 3.1466 Acc: 0.8028 Prec: 0.3035 Rec: 0.7900 F1: 0.4385 | BestT: 0.05
2025-12-11 01:04:56 | INFO | Epoch 30/200 (147.0s) | Train Loss: 2.8539 Acc: 0.9031 | Val Loss: 3.1535 Acc: 0.8188 Prec: 0.3192 Rec: 0.7580 F1: 0.4493 | BestT: 0.06
2025-12-11 01:07:22 | INFO | Epoch 31/200 (145.7s) | Train Loss: 2.8546 Acc: 0.8919 | Val Loss: 3.0163 Acc: 0.8103 Prec: 0.3080 Rec: 0.7580 F1: 0.4380 | BestT: 0.05
2025-12-11 01:07:22 | INFO | Early stopping at epoch 31
2025-12-11 01:07:22 | INFO | Training completed. Best Val F1: 0.4718 | Best T: 0.34
2025-12-11 01:07:26 | INFO | 
============================================================
2025-12-11 01:07:26 | INFO | TEST RESULTS (MLP Classifier)
2025-12-11 01:07:26 | INFO | ============================================================
2025-12-11 01:07:26 | INFO | Threshold:   0.34
2025-12-11 01:07:26 | INFO | Accuracy:    0.8322
2025-12-11 01:07:26 | INFO | Precision:   0.3381
2025-12-11 01:07:26 | INFO | Recall:      0.7534
2025-12-11 01:07:26 | INFO | F1-Score:    0.4668
2025-12-11 01:07:26 | INFO | AUC:         0.8715
2025-12-11 01:07:26 | INFO | TP:  165  FP:  323
2025-12-11 01:07:26 | INFO | FN:   54  TN: 1705
2025-12-11 01:07:26 | INFO | ============================================================

2025-12-11 01:07:27 | INFO | ===== Training & Evaluating Graph LogReg =====
2025-12-11 01:07:27 | INFO | Collecting features for LogReg training...
2025-12-11 01:08:01 | INFO | Before SMOTETomek: Neg=16219, Pos=1751
2025-12-11 01:08:53 | INFO | After SMOTETomek: Neg=14919, Pos=11675
2025-12-11 01:08:53 | INFO | LogReg feature dim: 2048, Train: 26594, Val: 2246
2025-12-11 01:08:53 | INFO | Training LogReg (C=1.0)...
2025-12-11 01:09:51 | INFO |   Val F1=0.3984 at T=0.05
2025-12-11 01:09:51 | INFO | ✓ Best LogReg: {'C': 1.0}, Val F1=0.3984, T=0.05
2025-12-11 01:09:52 | INFO | Collecting features for LogReg testing...
2025-12-11 01:09:56 | INFO | 
============================================================
2025-12-11 01:09:56 | INFO | TEST RESULTS (Graph + LogReg)
2025-12-11 01:09:56 | INFO | ============================================================
2025-12-11 01:09:56 | INFO | Params: {'C': 1.0}, Threshold: 0.05
2025-12-11 01:09:56 | INFO | Accuracy: 0.8006
2025-12-11 01:09:56 | INFO | Precision: 0.2884
2025-12-11 01:09:56 | INFO | Recall: 0.7123
2025-12-11 01:09:56 | INFO | F1-Score: 0.4105
2025-12-11 01:09:56 | INFO | AUC: 0.7981
2025-12-11 01:09:56 | INFO | TP:  156  FP:  385
2025-12-11 01:09:56 | INFO | FN:   63  TN: 1643
2025-12-11 01:09:56 | INFO | ============================================================

2025-12-11 01:09:56 | INFO | 
Ablation: wo_contrastive
2025-12-11 01:09:56 | INFO | Running experiment: wo_contrastive
2025-12-11 01:09:56 | INFO |   node_mil=True, tair=True, curriculum=True, pruning=True, contrastive=False
2025-12-11 01:09:57 | INFO | Starting training (Reborn Model with UnixCoder global func_emb)...
2025-12-11 01:09:59 | INFO | 
======================================================================
2025-12-11 01:09:59 | INFO | AUTO-CONFIGURATION FOR IMBALANCE
2025-12-11 01:09:59 | INFO | ======================================================================
2025-12-11 01:09:59 | INFO | Total: 17970, Neg: 16219, Pos: 1751
2025-12-11 01:09:59 | INFO | Imbalance ratio (neg:pos) = 9.26:1
2025-12-11 01:09:59 | INFO | → Severe imbalance, Focal + CE + Dice.
2025-12-11 01:09:59 | INFO | → Sufficient positives, SMOTE strategy=0.8.
2025-12-11 01:09:59 | INFO | → Class weights: [1.0, 6.09]
2025-12-11 01:09:59 | INFO | ======================================================================

2025-12-11 01:11:10 | INFO | Epoch 1/200 (71.0s) | Train Loss: 0.4515 Acc: 0.8425 | Val Loss: 23.6527 Acc: 0.6144 Prec: 0.1868 Rec: 0.8813 F1: 0.3083 | BestT: 0.19
2025-12-11 01:11:10 | INFO | ✓ Saved best model (Val F1: 0.3083, T=0.19)
2025-12-11 01:12:19 | INFO | Epoch 2/200 (68.6s) | Train Loss: 0.3909 Acc: 0.8577 | Val Loss: 24.3094 Acc: 0.8353 Prec: 0.3318 Rec: 0.6804 F1: 0.4461 | BestT: 0.30
2025-12-11 01:12:20 | INFO | ✓ Saved best model (Val F1: 0.4461, T=0.30)
2025-12-11 01:13:27 | INFO | Epoch 3/200 (67.0s) | Train Loss: 0.3548 Acc: 0.8609 | Val Loss: 25.0719 Acc: 0.8517 Prec: 0.3603 Rec: 0.6712 F1: 0.4689 | BestT: 0.35
2025-12-11 01:13:27 | INFO | ✓ Saved best model (Val F1: 0.4689, T=0.35)
2025-12-11 01:14:37 | INFO | Epoch 4/200 (69.9s) | Train Loss: 0.3319 Acc: 0.8699 | Val Loss: 25.3411 Acc: 0.8143 Prec: 0.3089 Rec: 0.7306 F1: 0.4342 | BestT: 0.23
2025-12-11 01:15:47 | INFO | Epoch 5/200 (69.3s) | Train Loss: 0.3221 Acc: 0.8729 | Val Loss: 26.0322 Acc: 0.8179 Prec: 0.3234 Rec: 0.7945 F1: 0.4597 | BestT: 0.25
2025-12-11 01:16:58 | INFO | Epoch 6/200 (70.4s) | Train Loss: 0.3191 Acc: 0.8730 | Val Loss: 24.4460 Acc: 0.8063 Prec: 0.3051 Rec: 0.7717 F1: 0.4373 | BestT: 0.26
2025-12-11 01:18:06 | INFO | Epoch 7/200 (67.8s) | Train Loss: 0.3054 Acc: 0.8766 | Val Loss: 24.7437 Acc: 0.7627 Prec: 0.2711 Rec: 0.8493 F1: 0.4110 | BestT: 0.23
2025-12-11 01:19:15 | INFO | Epoch 8/200 (69.0s) | Train Loss: 0.2905 Acc: 0.8813 | Val Loss: 24.9002 Acc: 0.7614 Prec: 0.2719 Rec: 0.8630 F1: 0.4136 | BestT: 0.08
2025-12-11 01:20:26 | INFO | Epoch 9/200 (70.2s) | Train Loss: 0.2809 Acc: 0.8859 | Val Loss: 24.9483 Acc: 0.7529 Prec: 0.2660 Rec: 0.8721 F1: 0.4077 | BestT: 0.10
2025-12-11 01:21:34 | INFO | Epoch 10/200 (68.3s) | Train Loss: 0.2792 Acc: 0.8836 | Val Loss: 24.9809 Acc: 0.7538 Prec: 0.2668 Rec: 0.8721 F1: 0.4086 | BestT: 0.10
2025-12-11 01:23:40 | INFO | Epoch 11/200 (125.6s) | Train Loss: 18.1928 Acc: 0.8915 | Val Loss: 9.3277 Acc: 0.7146 Prec: 0.2369 Rec: 0.8676 F1: 0.3722 | BestT: 0.05
2025-12-11 01:25:45 | INFO | Epoch 12/200 (124.8s) | Train Loss: 10.3793 Acc: 0.8900 | Val Loss: 7.3496 Acc: 0.8206 Prec: 0.3107 Rec: 0.6895 F1: 0.4284 | BestT: 0.05
2025-12-11 01:27:43 | INFO | Epoch 13/200 (116.8s) | Train Loss: 8.0165 Acc: 0.8891 | Val Loss: 6.0427 Acc: 0.7400 Prec: 0.2537 Rec: 0.8584 F1: 0.3917 | BestT: 0.15
2025-12-11 01:29:37 | INFO | Epoch 14/200 (114.5s) | Train Loss: 6.8075 Acc: 0.8880 | Val Loss: 5.4360 Acc: 0.7881 Prec: 0.2855 Rec: 0.7808 F1: 0.4181 | BestT: 0.05
2025-12-11 01:31:42 | INFO | Epoch 15/200 (124.0s) | Train Loss: 5.8653 Acc: 0.8886 | Val Loss: 4.7761 Acc: 0.7400 Prec: 0.2530 Rec: 0.8539 F1: 0.3904 | BestT: 0.11
2025-12-11 01:33:46 | INFO | Epoch 16/200 (124.2s) | Train Loss: 4.9568 Acc: 0.8864 | Val Loss: 4.5316 Acc: 0.8068 Prec: 0.2952 Rec: 0.7078 F1: 0.4167 | BestT: 0.05
2025-12-11 01:35:52 | INFO | Epoch 17/200 (125.1s) | Train Loss: 4.6359 Acc: 0.8918 | Val Loss: 4.1078 Acc: 0.7654 Prec: 0.2722 Rec: 0.8402 F1: 0.4112 | BestT: 0.07
2025-12-11 01:37:59 | INFO | Epoch 18/200 (126.7s) | Train Loss: 4.1511 Acc: 0.8934 | Val Loss: 3.8287 Acc: 0.7671 Prec: 0.2758 Rec: 0.8539 F1: 0.4169 | BestT: 0.10
2025-12-11 01:40:07 | INFO | Epoch 19/200 (127.8s) | Train Loss: 3.8762 Acc: 0.8897 | Val Loss: 3.7821 Acc: 0.8188 Prec: 0.3127 Rec: 0.7169 F1: 0.4355 | BestT: 0.05
2025-12-11 01:42:09 | INFO | Epoch 20/200 (121.6s) | Train Loss: 3.5366 Acc: 0.8949 | Val Loss: 3.5088 Acc: 0.7707 Prec: 0.2817 Rec: 0.8721 F1: 0.4259 | BestT: 0.06
2025-12-11 01:44:13 | INFO | Epoch 21/200 (123.4s) | Train Loss: 3.2758 Acc: 0.8967 | Val Loss: 3.4403 Acc: 0.7867 Prec: 0.2890 Rec: 0.8128 F1: 0.4263 | BestT: 0.05
2025-12-11 01:46:16 | INFO | Epoch 22/200 (122.9s) | Train Loss: 3.2396 Acc: 0.8985 | Val Loss: 3.2897 Acc: 0.7827 Prec: 0.2895 Rec: 0.8447 F1: 0.4312 | BestT: 0.08
2025-12-11 01:48:24 | INFO | Epoch 23/200 (127.5s) | Train Loss: 3.0198 Acc: 0.8987 | Val Loss: 3.2446 Acc: 0.7890 Prec: 0.2953 Rec: 0.8402 F1: 0.4371 | BestT: 0.06
2025-12-11 01:50:32 | INFO | Epoch 24/200 (127.3s) | Train Loss: 2.9853 Acc: 0.8977 | Val Loss: 3.2586 Acc: 0.8175 Prec: 0.3195 Rec: 0.7717 F1: 0.4519 | BestT: 0.05
2025-12-11 01:52:37 | INFO | Epoch 25/200 (124.9s) | Train Loss: 2.8438 Acc: 0.9031 | Val Loss: 3.1746 Acc: 0.7952 Prec: 0.2995 Rec: 0.8219 F1: 0.4390 | BestT: 0.05
2025-12-11 01:54:39 | INFO | Epoch 26/200 (122.0s) | Train Loss: 2.8227 Acc: 0.9016 | Val Loss: 3.1584 Acc: 0.8134 Prec: 0.3155 Rec: 0.7808 F1: 0.4494 | BestT: 0.07
2025-12-11 01:56:46 | INFO | Epoch 27/200 (126.9s) | Train Loss: 2.7963 Acc: 0.9042 | Val Loss: 3.1490 Acc: 0.8001 Prec: 0.3010 Rec: 0.7945 F1: 0.4366 | BestT: 0.05
2025-12-11 01:58:53 | INFO | Epoch 28/200 (125.9s) | Train Loss: 2.8012 Acc: 0.9050 | Val Loss: 3.1499 Acc: 0.8054 Prec: 0.3067 Rec: 0.7900 F1: 0.4419 | BestT: 0.05
2025-12-11 01:58:53 | INFO | Early stopping at epoch 28
2025-12-11 01:58:53 | INFO | Training completed. Best Val F1: 0.4689 | Best T: 0.35
2025-12-11 01:58:58 | INFO | 
============================================================
2025-12-11 01:58:58 | INFO | TEST RESULTS (MLP Classifier)
2025-12-11 01:58:58 | INFO | ============================================================
2025-12-11 01:58:58 | INFO | Threshold:   0.35
2025-12-11 01:58:58 | INFO | Accuracy:    0.8407
2025-12-11 01:58:58 | INFO | Precision:   0.3431
2025-12-11 01:58:58 | INFO | Recall:      0.6941
2025-12-11 01:58:58 | INFO | F1-Score:    0.4592
2025-12-11 01:58:58 | INFO | AUC:         0.8687
2025-12-11 01:58:58 | INFO | TP:  152  FP:  291
2025-12-11 01:58:58 | INFO | FN:   67  TN: 1737
2025-12-11 01:58:58 | INFO | ============================================================

2025-12-11 01:58:58 | INFO | ===== Training & Evaluating Graph LogReg =====
2025-12-11 01:58:58 | INFO | Collecting features for LogReg training...
2025-12-11 01:59:35 | INFO | Before SMOTETomek: Neg=16219, Pos=1751
2025-12-11 02:00:27 | INFO | After SMOTETomek: Neg=14917, Pos=11673
2025-12-11 02:00:27 | INFO | LogReg feature dim: 2048, Train: 26590, Val: 2246
2025-12-11 02:00:27 | INFO | Training LogReg (C=1.0)...
2025-12-11 02:01:26 | INFO |   Val F1=0.3930 at T=0.05
2025-12-11 02:01:26 | INFO | ✓ Best LogReg: {'C': 1.0}, Val F1=0.3930, T=0.05
2025-12-11 02:01:26 | INFO | Collecting features for LogReg testing...
2025-12-11 02:01:30 | INFO | 
============================================================
2025-12-11 02:01:30 | INFO | TEST RESULTS (Graph + LogReg)
2025-12-11 02:01:30 | INFO | ============================================================
2025-12-11 02:01:30 | INFO | Params: {'C': 1.0}, Threshold: 0.05
2025-12-11 02:01:30 | INFO | Accuracy: 0.7788
2025-12-11 02:01:30 | INFO | Precision: 0.2772
2025-12-11 02:01:30 | INFO | Recall: 0.7900
2025-12-11 02:01:30 | INFO | F1-Score: 0.4104
2025-12-11 02:01:30 | INFO | AUC: 0.8047
2025-12-11 02:01:30 | INFO | TP:  173  FP:  451
2025-12-11 02:01:30 | INFO | FN:   46  TN: 1577
2025-12-11 02:01:30 | INFO | ============================================================

2025-12-11 02:01:31 | INFO | 
Ablation: baseline
2025-12-11 02:01:31 | INFO | Running experiment: baseline
2025-12-11 02:01:31 | INFO |   node_mil=False, tair=False, curriculum=False, pruning=False, contrastive=False
2025-12-11 02:01:31 | INFO | Starting training (Reborn Model with UnixCoder global func_emb)...
2025-12-11 02:01:34 | INFO | 
======================================================================
2025-12-11 02:01:34 | INFO | AUTO-CONFIGURATION FOR IMBALANCE
2025-12-11 02:01:34 | INFO | ======================================================================
2025-12-11 02:01:34 | INFO | Total: 17970, Neg: 16219, Pos: 1751
2025-12-11 02:01:34 | INFO | Imbalance ratio (neg:pos) = 9.26:1
2025-12-11 02:01:34 | INFO | → Severe imbalance, Focal + CE + Dice.
2025-12-11 02:01:34 | INFO | → Sufficient positives, SMOTE strategy=0.8.
2025-12-11 02:01:34 | INFO | → Class weights: [1.0, 6.09]
2025-12-11 02:01:34 | INFO | ======================================================================

2025-12-11 02:02:33 | INFO | Epoch 1/200 (58.8s) | Train Loss: 0.4591 Acc: 0.8412 | Val Loss: 0.3640 Acc: 0.8175 Prec: 0.3023 Rec: 0.6667 F1: 0.4160 | BestT: 0.50
2025-12-11 02:02:33 | INFO | ✓ Saved best model (Val F1: 0.4160, T=0.50)
2025-12-11 02:03:35 | INFO | Epoch 2/200 (61.4s) | Train Loss: 0.3853 Acc: 0.8504 | Val Loss: 0.3773 Acc: 0.7511 Prec: 0.2578 Rec: 0.8265 F1: 0.3931 | BestT: 0.10
2025-12-11 02:04:38 | INFO | Epoch 3/200 (63.6s) | Train Loss: 0.3621 Acc: 0.8621 | Val Loss: 0.3544 Acc: 0.8005 Prec: 0.2959 Rec: 0.7580 F1: 0.4256 | BestT: 0.50
2025-12-11 02:04:38 | INFO | ✓ Saved best model (Val F1: 0.4256, T=0.50)
2025-12-11 02:05:42 | INFO | Epoch 4/200 (63.1s) | Train Loss: 0.3395 Acc: 0.8702 | Val Loss: 0.3605 Acc: 0.7676 Prec: 0.2749 Rec: 0.8447 F1: 0.4148 | BestT: 0.11
2025-12-11 02:06:44 | INFO | Epoch 5/200 (61.3s) | Train Loss: 0.3199 Acc: 0.8746 | Val Loss: 0.3580 Acc: 0.8531 Prec: 0.3650 Rec: 0.6849 F1: 0.4762 | BestT: 0.68
2025-12-11 02:06:44 | INFO | ✓ Saved best model (Val F1: 0.4762, T=0.68)
2025-12-11 02:07:50 | INFO | Epoch 6/200 (65.7s) | Train Loss: 0.3016 Acc: 0.8817 | Val Loss: 0.3426 Acc: 0.8255 Prec: 0.3314 Rec: 0.7763 F1: 0.4645 | BestT: 0.37
2025-12-11 02:08:56 | INFO | Epoch 7/200 (65.9s) | Train Loss: 0.2889 Acc: 0.8862 | Val Loss: 0.3445 Acc: 0.8237 Prec: 0.3321 Rec: 0.7991 F1: 0.4692 | BestT: 0.27
2025-12-11 02:10:01 | INFO | Epoch 8/200 (64.4s) | Train Loss: 0.2756 Acc: 0.8879 | Val Loss: 0.3623 Acc: 0.8357 Prec: 0.3469 Rec: 0.7763 F1: 0.4795 | BestT: 0.21
2025-12-11 02:10:01 | INFO | ✓ Saved best model (Val F1: 0.4795, T=0.21)
2025-12-11 02:11:06 | INFO | Epoch 9/200 (64.7s) | Train Loss: 0.2658 Acc: 0.8919 | Val Loss: 0.3522 Acc: 0.8264 Prec: 0.3384 Rec: 0.8174 F1: 0.4786 | BestT: 0.20
2025-12-11 02:12:12 | INFO | Epoch 10/200 (65.9s) | Train Loss: 0.2616 Acc: 0.8910 | Val Loss: 0.3618 Acc: 0.8264 Prec: 0.3384 Rec: 0.8174 F1: 0.4786 | BestT: 0.16
2025-12-11 02:13:15 | INFO | Epoch 11/200 (62.4s) | Train Loss: 0.2998 Acc: 0.8853 | Val Loss: 0.4721 Acc: 0.8455 Prec: 0.3603 Rec: 0.7534 F1: 0.4874 | BestT: 0.07
2025-12-11 02:13:15 | INFO | ✓ Saved best model (Val F1: 0.4874, T=0.07)
2025-12-11 02:14:17 | INFO | Epoch 12/200 (62.0s) | Train Loss: 0.2956 Acc: 0.8849 | Val Loss: 0.3466 Acc: 0.8299 Prec: 0.3405 Rec: 0.7945 F1: 0.4767 | BestT: 0.33
2025-12-11 02:15:20 | INFO | Epoch 13/200 (62.7s) | Train Loss: 0.2829 Acc: 0.8869 | Val Loss: 0.3450 Acc: 0.8317 Prec: 0.3432 Rec: 0.7945 F1: 0.4793 | BestT: 0.30
2025-12-11 02:16:22 | INFO | Epoch 14/200 (61.6s) | Train Loss: 0.2721 Acc: 0.8870 | Val Loss: 0.3521 Acc: 0.8192 Prec: 0.3315 Rec: 0.8402 F1: 0.4755 | BestT: 0.13
2025-12-11 02:17:26 | INFO | Epoch 15/200 (63.1s) | Train Loss: 0.2587 Acc: 0.8935 | Val Loss: 0.3469 Acc: 0.8379 Prec: 0.3541 Rec: 0.8037 F1: 0.4916 | BestT: 0.38
2025-12-11 02:17:26 | INFO | ✓ Saved best model (Val F1: 0.4916, T=0.38)
2025-12-11 02:18:29 | INFO | Epoch 16/200 (63.0s) | Train Loss: 0.2470 Acc: 0.8932 | Val Loss: 0.4100 Acc: 0.8339 Prec: 0.3508 Rec: 0.8265 F1: 0.4925 | BestT: 0.08
2025-12-11 02:18:29 | INFO | ✓ Saved best model (Val F1: 0.4925, T=0.08)
2025-12-11 02:19:33 | INFO | Epoch 17/200 (63.5s) | Train Loss: 0.2448 Acc: 0.8963 | Val Loss: 0.5496 Acc: 0.8553 Prec: 0.3750 Rec: 0.7260 F1: 0.4946 | BestT: 0.05
2025-12-11 02:19:33 | INFO | ✓ Saved best model (Val F1: 0.4946, T=0.05)
2025-12-11 02:20:37 | INFO | Epoch 18/200 (62.9s) | Train Loss: 0.2303 Acc: 0.8996 | Val Loss: 0.3968 Acc: 0.8415 Prec: 0.3605 Rec: 0.8082 F1: 0.4986 | BestT: 0.20
2025-12-11 02:20:37 | INFO | ✓ Saved best model (Val F1: 0.4986, T=0.20)
2025-12-11 02:21:39 | INFO | Epoch 19/200 (62.5s) | Train Loss: 0.2266 Acc: 0.8999 | Val Loss: 0.4028 Acc: 0.8206 Prec: 0.3303 Rec: 0.8174 F1: 0.4704 | BestT: 0.13
2025-12-11 02:22:41 | INFO | Epoch 20/200 (61.4s) | Train Loss: 0.2145 Acc: 0.9021 | Val Loss: 0.4265 Acc: 0.8344 Prec: 0.3515 Rec: 0.8265 F1: 0.4932 | BestT: 0.10
2025-12-11 02:23:42 | INFO | Epoch 21/200 (60.4s) | Train Loss: 0.2073 Acc: 0.9032 | Val Loss: 0.3970 Acc: 0.8602 Prec: 0.3882 Rec: 0.7534 F1: 0.5124 | BestT: 0.44
2025-12-11 02:23:42 | INFO | ✓ Saved best model (Val F1: 0.5124, T=0.44)
2025-12-11 02:24:46 | INFO | Epoch 22/200 (64.0s) | Train Loss: 0.1992 Acc: 0.9046 | Val Loss: 0.4046 Acc: 0.8353 Prec: 0.3545 Rec: 0.8402 F1: 0.4986 | BestT: 0.18
2025-12-11 02:25:49 | INFO | Epoch 23/200 (62.0s) | Train Loss: 0.1918 Acc: 0.9066 | Val Loss: 0.4677 Acc: 0.8406 Prec: 0.3585 Rec: 0.8037 F1: 0.4958 | BestT: 0.11
2025-12-11 02:26:51 | INFO | Epoch 24/200 (62.1s) | Train Loss: 0.1908 Acc: 0.9061 | Val Loss: 0.4625 Acc: 0.8415 Prec: 0.3616 Rec: 0.8174 F1: 0.5014 | BestT: 0.10
2025-12-11 02:27:54 | INFO | Epoch 25/200 (62.5s) | Train Loss: 0.1831 Acc: 0.9096 | Val Loss: 0.5088 Acc: 0.8353 Prec: 0.3517 Rec: 0.8174 F1: 0.4918 | BestT: 0.05
2025-12-11 02:28:56 | INFO | Epoch 26/200 (62.3s) | Train Loss: 0.1777 Acc: 0.9098 | Val Loss: 0.5205 Acc: 0.8415 Prec: 0.3599 Rec: 0.8037 F1: 0.4972 | BestT: 0.05
2025-12-11 02:30:00 | INFO | Epoch 27/200 (63.0s) | Train Loss: 0.1801 Acc: 0.9095 | Val Loss: 0.5462 Acc: 0.8513 Prec: 0.3736 Rec: 0.7763 F1: 0.5045 | BestT: 0.08
2025-12-11 02:31:04 | INFO | Epoch 28/200 (63.8s) | Train Loss: 0.1739 Acc: 0.9104 | Val Loss: 0.5497 Acc: 0.8508 Prec: 0.3728 Rec: 0.7763 F1: 0.5037 | BestT: 0.08
2025-12-11 02:32:07 | INFO | Epoch 29/200 (63.1s) | Train Loss: 0.1724 Acc: 0.9114 | Val Loss: 0.5677 Acc: 0.8486 Prec: 0.3693 Rec: 0.7808 F1: 0.5015 | BestT: 0.05
2025-12-11 02:33:13 | INFO | Epoch 30/200 (65.4s) | Train Loss: 0.1778 Acc: 0.9099 | Val Loss: 0.5646 Acc: 0.8486 Prec: 0.3693 Rec: 0.7808 F1: 0.5015 | BestT: 0.05
2025-12-11 02:34:15 | INFO | Epoch 31/200 (61.2s) | Train Loss: 0.2195 Acc: 0.9019 | Val Loss: 0.7019 Acc: 0.8531 Prec: 0.3630 Rec: 0.6712 F1: 0.4712 | BestT: 0.05
2025-12-11 02:35:19 | INFO | Epoch 32/200 (64.0s) | Train Loss: 0.2164 Acc: 0.9020 | Val Loss: 0.5360 Acc: 0.8402 Prec: 0.3548 Rec: 0.7808 F1: 0.4879 | BestT: 0.05
2025-12-11 02:36:22 | INFO | Epoch 33/200 (62.3s) | Train Loss: 0.2085 Acc: 0.9032 | Val Loss: 0.5334 Acc: 0.8375 Prec: 0.3498 Rec: 0.7763 F1: 0.4823 | BestT: 0.08
2025-12-11 02:37:23 | INFO | Epoch 34/200 (61.4s) | Train Loss: 0.2121 Acc: 0.9030 | Val Loss: 0.5805 Acc: 0.8330 Prec: 0.3427 Rec: 0.7763 F1: 0.4755 | BestT: 0.05
2025-12-11 02:38:25 | INFO | Epoch 35/200 (61.5s) | Train Loss: 0.2091 Acc: 0.9046 | Val Loss: 0.9617 Acc: 0.8615 Prec: 0.3655 Rec: 0.5708 F1: 0.4456 | BestT: 0.05
2025-12-11 02:39:26 | INFO | Epoch 36/200 (60.0s) | Train Loss: 0.1981 Acc: 0.9035 | Val Loss: 0.7417 Acc: 0.8598 Prec: 0.3776 Rec: 0.6758 F1: 0.4845 | BestT: 0.08
2025-12-11 02:40:26 | INFO | Epoch 37/200 (60.1s) | Train Loss: 0.2029 Acc: 0.9057 | Val Loss: 0.5817 Acc: 0.8442 Prec: 0.3585 Rec: 0.7580 F1: 0.4868 | BestT: 0.05
2025-12-11 02:41:28 | INFO | Epoch 38/200 (61.7s) | Train Loss: 0.1929 Acc: 0.9070 | Val Loss: 0.4778 Acc: 0.8032 Prec: 0.3074 Rec: 0.8128 F1: 0.4461 | BestT: 0.06
2025-12-11 02:42:29 | INFO | Epoch 39/200 (60.4s) | Train Loss: 0.1884 Acc: 0.9063 | Val Loss: 0.7767 Acc: 0.8522 Prec: 0.3671 Rec: 0.7123 F1: 0.4845 | BestT: 0.05
2025-12-11 02:43:31 | INFO | Epoch 40/200 (61.9s) | Train Loss: 0.1858 Acc: 0.9079 | Val Loss: 0.5548 Acc: 0.8384 Prec: 0.3525 Rec: 0.7854 F1: 0.4866 | BestT: 0.09
2025-12-11 02:44:35 | INFO | Epoch 41/200 (63.4s) | Train Loss: 0.1839 Acc: 0.9088 | Val Loss: 0.6110 Acc: 0.8295 Prec: 0.3398 Rec: 0.7945 F1: 0.4761 | BestT: 0.05
2025-12-11 02:45:37 | INFO | Epoch 42/200 (62.0s) | Train Loss: 0.1840 Acc: 0.9075 | Val Loss: 0.5815 Acc: 0.8344 Prec: 0.3467 Rec: 0.7900 F1: 0.4819 | BestT: 0.05
2025-12-11 02:46:40 | INFO | Epoch 43/200 (62.2s) | Train Loss: 0.1775 Acc: 0.9094 | Val Loss: 0.8496 Acc: 0.8495 Prec: 0.3486 Rec: 0.6256 F1: 0.4477 | BestT: 0.05
2025-12-11 02:47:42 | INFO | Epoch 44/200 (62.2s) | Train Loss: 0.1789 Acc: 0.9100 | Val Loss: 1.0619 Acc: 0.8446 Prec: 0.3253 Rec: 0.5525 F1: 0.4095 | BestT: 0.05
2025-12-11 02:48:48 | INFO | Epoch 45/200 (65.6s) | Train Loss: 0.1748 Acc: 0.9089 | Val Loss: 0.9303 Acc: 0.8513 Prec: 0.3491 Rec: 0.6073 F1: 0.4433 | BestT: 0.05
2025-12-11 02:49:51 | INFO | Epoch 46/200 (62.5s) | Train Loss: 0.1699 Acc: 0.9093 | Val Loss: 0.9675 Acc: 0.8459 Prec: 0.3316 Rec: 0.5708 F1: 0.4195 | BestT: 0.05
2025-12-11 02:49:51 | INFO | Early stopping at epoch 46
2025-12-11 02:49:51 | INFO | Training completed. Best Val F1: 0.5124 | Best T: 0.44
2025-12-11 02:49:56 | INFO | 
============================================================
2025-12-11 02:49:56 | INFO | TEST RESULTS (MLP Classifier)
2025-12-11 02:49:56 | INFO | ============================================================
2025-12-11 02:49:56 | INFO | Threshold:   0.44
2025-12-11 02:49:56 | INFO | Accuracy:    0.8558
2025-12-11 02:49:56 | INFO | Precision:   0.3747
2025-12-11 02:49:56 | INFO | Recall:      0.7169
2025-12-11 02:49:56 | INFO | F1-Score:    0.4922
2025-12-11 02:49:56 | INFO | AUC:         0.8579
2025-12-11 02:49:56 | INFO | TP:  157  FP:  262
2025-12-11 02:49:56 | INFO | FN:   62  TN: 1766
2025-12-11 02:49:56 | INFO | ============================================================

2025-12-11 02:49:56 | INFO | ===== Training & Evaluating Graph LogReg =====
2025-12-11 02:49:56 | INFO | Collecting features for LogReg training...
2025-12-11 02:50:32 | INFO | Before SMOTETomek: Neg=16219, Pos=1751
2025-12-11 02:51:24 | INFO | After SMOTETomek: Neg=14920, Pos=11676
2025-12-11 02:51:24 | INFO | LogReg feature dim: 2048, Train: 26596, Val: 2246
2025-12-11 02:51:24 | INFO | Training LogReg (C=1.0)...
2025-12-11 02:52:26 | INFO |   Val F1=0.3684 at T=0.05
2025-12-11 02:52:26 | INFO | ✓ Best LogReg: {'C': 1.0}, Val F1=0.3684, T=0.05
2025-12-11 02:52:26 | INFO | Collecting features for LogReg testing...
2025-12-11 02:52:30 | INFO | 
============================================================
2025-12-11 02:52:30 | INFO | TEST RESULTS (Graph + LogReg)
2025-12-11 02:52:30 | INFO | ============================================================
2025-12-11 02:52:30 | INFO | Params: {'C': 1.0}, Threshold: 0.05
2025-12-11 02:52:30 | INFO | Accuracy: 0.8362
2025-12-11 02:52:30 | INFO | Precision: 0.3133
2025-12-11 02:52:30 | INFO | Recall: 0.5708
2025-12-11 02:52:30 | INFO | F1-Score: 0.4045
2025-12-11 02:52:30 | INFO | AUC: 0.8184
2025-12-11 02:52:30 | INFO | TP:  125  FP:  274
2025-12-11 02:52:30 | INFO | FN:   94  TN: 1754
2025-12-11 02:52:30 | INFO | ============================================================

2025-12-11 02:52:31 | INFO | 
================================================================================
2025-12-11 02:52:31 | INFO | STEP 4: Generating Reports
2025-12-11 02:52:31 | INFO | ================================================================================

2025-12-11 02:52:31 | INFO | ✓ Results saved to: ./experiments_reborn/Reveal_unixcoder_reborn_20251210_202348/results/all_results.json
2025-12-11 02:52:31 | INFO | 
Comparison Table:
2025-12-11 02:52:31 | INFO | 
    Experiment Acc_MLP F1_MLP AUC_MLP Acc_LogReg F1_LogReg AUC_LogReg
    full_model  0.8371 0.4741  0.8786     0.8131    0.4370     0.8108
   wo_node_mil  0.8278 0.4587  0.8763     0.7882    0.3850     0.7851
       wo_tair  0.8496 0.5101  0.8843     0.8296    0.4206     0.8036
 wo_curriculum  0.8322 0.4668  0.8715     0.8006    0.4105     0.7981
wo_contrastive  0.8407 0.4592  0.8687     0.7788    0.4104     0.8047
      baseline  0.8558 0.4922  0.8579     0.8362    0.4045     0.8184
2025-12-11 02:52:31 | INFO | ✓ Table saved to: ./experiments_reborn/Reveal_unixcoder_reborn_20251210_202348/results/comparison_table.csv
2025-12-11 02:52:33 | INFO | ✓ All plots saved to: ./experiments_reborn/Reveal_unixcoder_reborn_20251210_202348/plots
2025-12-11 02:52:33 | INFO | 
================================================================================
2025-12-11 02:52:33 | INFO | ALL EXPERIMENTS COMPLETED!
2025-12-11 02:52:33 | INFO | ================================================================================

2025-12-11 02:52:34 | INFO | 
================================================================================
2025-12-11 02:52:34 | INFO | 🎉 SUCCESS! All experiments completed.
2025-12-11 02:52:34 | INFO | Results saved to: ./experiments_reborn/Reveal_unixcoder_reborn_20251210_202348
2025-12-11 02:52:34 | INFO | ================================================================================

